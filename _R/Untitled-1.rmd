---
title: "Tidy Data"
permalink: /R/hoho
collection: R
output: md_document
---



```{r, warning = FALSE, message = FALSE}
library(tidyverse)
```

##### **What is tidy data?**

There are three interrelated rules which make a dataset tidy:

    1. Each variable must have its own column
    2. Each observation must have its own row
    3. Each value must have its own cell

These three rules are interrelated because it is impossible to only satisfy two of the three.

##### **Pivoting**

There are two general ways in which a dataset can be untidy:

    1. One variable might be spread over multiple columns
    2. One observation might be scattered across multiple rows

In order to tidy such datasets we will use `pivot_longer()` and `pivot_wider()`

###### Longer Pivoting

Longer pivoting a dataset is needed when columns not variables but *values* of a variable. Lets take as an example table4a:

```{r}
table4a
```

The columns 1999 and 2000 are not variables but observations of the variable _years_. To tidy our dataset we need to **pivot** these two columns using three parameters:

    1: The set of columns that are **values** and not variables. In this case: `1999` and `2000` 
    2: The name of the variable to move the column **names** to. In this case: `years`
    3: The name of the variable to move the column **values** to

Together those parameters generate the call to `pivot_longer()`:

```{r pivotlonger}
tidy4a <- table4a %>%
  pivot_longer(
    c(`1999`, `2000`),
    names_to = "year",
    values_to = "cases"
    )
```

`year` and `cases` do not exist in table4a so we put their names in quotes.

We can use pivot_longer() to tidy table4b in a similar fashion. The only difference is the variable stored in the cell values:

```{r pivotlonger2}
tidy4b <- table4b %>% 
  pivot_longer(
    c(`1999`, `2000`), 
    names_to = "year", 
    values_to = "population")
```

To join the tidied versions of table4a and table4b into a single tibble, we need to use `dplyr::left_join()` :

```{r letfjoining}
left_join(tidy4a, tidy4b)
```

###### Wider Pivoting

Wider pivoting a dataset is needed when an observation is scattered across multiple rows, or two columns are "stacked" into one. An example can be seen in `table2`, where an observation is a country in a year, but each observation is spread across two rows:

```{r}
table2
```




